import os

import matplotlib.pyplot as plt
import numpy as np
import pydicom as pdcm
from scipy.ndimage import zoom

from utility import rle_decode_modified, mask2rle, rle_decode
import pandas as pd
import cv2


def make_plots():
    pneumo = "606355 2 1020 8 1015 12 1011 12 1010 14 1009 15 1008 16 1007 17 1006 18 1005 19 1004 20 1003 21 1003 20 1003 21 1003 21 1002 22 1002 21 1002 22 1002 22 1001 23 1001 22 1001 23 1001 23 1001 23 1000 24 1000 23 1000 24 1000 24 1000 24 999 24 1000 24 1000 24 999 25 999 24 1000 24 999 25 999 25 999 24 1000 24 1000 24 1000 24 1000 24 1000 23 1000 24 1000 24 1000 24 1000 24 1000 24 1000 24 1000 24 1000 24 1000 24 999 25 999 25 999 25 999 25 999 25 999 25 999 25 999 25 999 25 999 25 999 25 999 25 999 25 999 25 999 26 998 26 998 26 998 26 999 25 999 26 998 26 998 26 998 26 998 27 997 27 997 27 997 27 998 27 997 27 997 27 997 27 998 27 997 27 997 28 996 28 997 28 996 28 996 29 995 29 996 29 995 29 995 29 995 30 995 29 995 30 994 30 995 29 995 30 995 29 995 30 994 30 995 30 994 31 994 30 995 30 994 30 995 30 995 29 995 30 995 29 996 29 995 29 996 29 996 29 995 29 996 29 996 29 995 29 996 29 996 29 995 29 996 29 995 29 996 29 996 28 996 29 996 28 997 28 996 28 997 27 998 27 998 26 998 27 998 26 999 25 999 26 999 25 1000 25 1000 24 1001 24 1001 23 1001 24 1001 23 1002 23 1002 22 1003 21 1004 21 1004 20 1005 20 1005 19 1006 18 1008 17 1008 16 1009 16 1010 14 1011 14 1011 14 1012 12 1013 12 1013 12 1013 11 1014 11 1014 11 1015 9 1016 9 1016 9 1016 9 1016 9 1016 9 1016 9 1016 9 1016 9 1016 10 1015 10 1015 10 1015 11 1014 11 1014 12 1013 12 1014 12 1013 13 1012 13 1013 13 1013 12 1014 11 1015 11 1015 10 1015 10 1016 9 1016 10 1015 10 1016 9 1016 10 1016 9 1016 9 1016 10 1016 9 1016 10 1016 10 1015 11 1014 12 1014 12 1013 13 1012 14 1011 16 1010 16 1009 18 1007 19 1006 20 1006 20 1006 20 1006 19 1007 19 1007 18 1008 18 1008 18 1008 18 1009 17 1009 18 1009 18 1009 17 1009 18 1009 20 1007 24 1002 26 1001 27 1000 26 1000 27 1000 27 1000 26 1000 27 1000 26 1001 25 1001 25 1003 23 1005 20 1008 18 1010 16 1013 13 1015 10"
    rib1 = "768197 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60 964 60"
    rib2 = "778505 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69 955 69"
    rib3 = "780636 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64 960 64"
    tube = "795213 19 1004 1 18 1 1004 1 18 1 1003 1 19 1 1003 1 19 1 1002 1 20 1 1002 1 20 1 1001 1 21 1 1001 1 21 1 1000 1 22 1 1000 1 22 1 999 1 23 1 999 1 23 1 998 1 24 1 998 1 24 1 997 1 25 1 997 1 25 1 996 1 26 1 996 1 26 1 995 1 27 1 995 1 27 1 994 1 28 1 994 1 28 1 994 1 28 1 994 1 28 1 994 1 27 1 995 1 26 1 996 1 25 1 997 1 25 1 997 1 24 1 998 1 23 1 999 1 22 1 1000 1 21 1 1001 1 20 1 1002 1 20 1 1002 1 19 1 1003 1 18 1 1004 1 17 1 1005 1 16 1 929 2 75 1 15 1 932 4 71 1 15 1 936 4 67 1 14 1 941 4 63 1 13 1 946 4 59 1 12 1 951 4 55 1 11 1 956 4 51 1 10 1 961 4 48 1 9 1 965 4 44 1 8 1 970 3 41 1 7 1 974 2 39 1 5 2 977 2 37 1 3 2 981 1 37 3 984 2 34 2 988 2 29 3 1 1 990 1 26 2 4 1 991 2 22 2 6 1 993 2 18 2 9 1 994 2 13 3 11 1 996 1 10 2 14 1 997 2 6 2 16 1 999 2 2 2 18 1 1001 2 21 1 1023 1 1023 1 1023 1 1023 1 1024 1 1023 1 1023 1 1023 1 1023 1 1024 1 1023 1 1023 1 1023 1 1023 1 1024 1 1023 1 1023 1 1023 1 1023 1 1023 1 1024 1 1023 1 1023 1 1023 1 1023 1 1024 1 1023 1 1023 1 1023 1 1024 1 1023 1 1023 1 1023 1 1024 1 1023 1 1023 1 1024 1 1023 1 1023 1 1023 1 1024 1 1023 1 1023 1 1024 1 1023 1 1023 1 1023 1 1024 1 1023 1 1024 1 1023 1 1024 1 1023 1 1024 1 1023 1 1024 1 1024 1 1023 1 1024 1 1023 1 1024 1 1023 1 1024 1 1023 1 1024 3 1024 4 1024 5 1024 4 1024 5 1024 5 1024 4 1024 5 1024 5 1024 6 1024 5 1024 5 1024 5 1024 6 1024 5 1024 6 1024 6 1024 6 1024 7 1024 6 1024 6 1024 7 1024 6 1024 6 1024 6 1024 5 1024 5 1024 5 1024 6 1024 5 1024 5 1024 5 1024 5 1024 5 1024 5 1024 5 1024 6 1024 5 1024 5 1024 5 1024 5 1024 5 1024 5 1024 5 1024 6 1024 5 1024 5 1024 5 1024 5 1024 5 1024 5 1024 6 1024 5 1024 5 1024 5 1024 5 1024 5 1024 5 1024 5 1024 6 1024 5 1024 5 1024 5 1024 3"


    test1 = "208490 6 965 17 27 26 944 85 937 97 130 14 781 104 70 73 775 111 58 82 770 120 47 90 763 265 757 269 752 274 747 277 743 282 737 286 734 290 730 293 728 295 727 297 724 299 723 300 722 302 720 303 720 303 720 302 720 303 719 304 718 305 717 306 716 307 715 308 715 309 713 310 712 311 710 313 709 315 707 316 706 317 706 317 705 318 704 320 702 321 702 321 701 323 699 324 698 326 696 327 695 329 693 331 691 333 689 334 688 336 686 337 685 339 682 341 681 343 679 345 677 347 675 349 672 351 669 354 668 356 665 358 662 361 660 364 658 366 656 368 653 370 651 372 651 373 649 374 647 376 645 379 644 379 643 381 642 381 641 382 640 384 638 385 637 386 636 388 634 390 631 393 630 393 630 394 628 395 627 397 625 398 625 399 623 400 623 401 622 401 621 402 621 402 620 404 619 404 619 403 620 402 621 401 622 400 623 399 624 398 625 398 625 397 626 397 626 397 626 396 627 396 627 395 628 394 629 394 630 392 631 392 631 391 633 389 634 389 634 389 634 390 634 389 634 389 634 389 634 390 634 389 634 389 634 388 635 388 636 387 636 387 636 387 637 386 637 386 637 386 638 386 637 386 638 386 637 386 637 387 636 388 636 387 636 387 636 388 636 387 637 387 636 387 637 386 637 387 637 386 637 386 637 386 638 385 638 385 639 385 638 385 639 384 639 385 638 385 639 384 639 384 639 383 641 382 642 381 643 381 643 381 643 381 643 380 643 380 644 379 644 379 645 378 646 378 645 379 645 379 644 380 644 379 645 377 647 376 648 373 650 370 654 367 657 366 658 366 658 365 659 364 660 363 660 363 661 362 662 361 662 361 663 360 663 359 665 358 666 357 667 355 668 354 670 352 672 350 674 349 675 348 675 348 676 347 677 346 678 344 680 342 681 341 683 340 684 338 686 337 687 335 688 334 690 332 692 330 694 327 697 322 702 314 710 313 711 312 712 309 715 304 720 301 723 299 725 295 729 290 734 288 736 286 738 285 739 284 740 282 742 281 743 280 744 280 744 279 745 279 745 278 746 277 747 277 747 276 748 275 749 274 750 274 749 274 750 273 751 271 753 270 754 269 755 268 757 266 758 265 759 263 761 262 763 260 764 260 765 258 766 257 767 257 768 255 769 255 769 255 769 255 769 254 770 253 772 251 773 251 773 250 774 249 775 248 776 248 777 246 778 245 779 245 779 244 781 242 782 241 784 240 784 239 786 237 787 236 788 236 788 235 790 233 791 232 793 230 795 228 796 227 798 226 798 225 799 224 800 223 802 222 802 221 804 219 806 217 807 217 808 215 809 214 811 213 811 213 812 212 812 211 814 209 815 209 816 207 818 205 819 205 820 204 820 204 820 203 821 202 822 202 822 201 823 200 823 200 824 200 823 200 824 199 824 200 823 199 825 197 826 195 831 191 835 187 839 183 843 179 852 169 857 165 863 159 875 147 882 135 895 127 903 117 916 105 929 93 941 79 951 68 966 52 978 40"
    test2 = "218477 3 1016 6 1016 5 1016 6 1015 7 1013 9 1011 11 1011 11 1010 12 1010 12 1010 12 1010 12 1010 12 1010 12 1010 12 1010 12 1010 13 1008 14 1008 15 1007 16 1006 16 1006 17 1005 17 1005 18 1004 19 1003 19 1003 20 1002 20 1002 21 1001 22 1000 22 1000 23 999 24 998 24 998 25 997 26 997 26 996 27 995 28 994 28 994 29 993 30 992 31 991 32 991 32 990 33 989 34 988 35 987 36 986 37 986 37 986 37 985 38 985 38 984 39 984 39 984 39 983 40 983 40 983 40 983 40 983 40 983 41 982 41 982 41 982 42 981 42 980 43 980 43 980 43 980 43 980 44 979 44 980 43 980 43 980 43 980 44 979 44 979 44 980 44 979 44 979 44 979 44 979 45 978 45 979 44 979 45 978 45 979 44 979 44 979 45 978 45 979 44 979 45 978 45 979 44 979 45 978 45 978 45 979 45 978 45 978 46 978 45 978 45 978 46 977 46 978 45 978 46 977 46 978 45 978 46 977 46 978 46 977 46 978 46 977 46 978 46 977 46 978 45 978 46 978 45 978 45 979 45 978 45 978 45 979 45 978 45 979 45 979 44 979 45 979 44 979 45 979 44 980 44 979 44 980 43 981 43 980 43 981 43 980 43 981 43 981 42 981 43 981 42 982 42 982 41 983 41 982 41 983 41 983 41 983 40 983 41 983 40 984 40 984 40 984 39 985 39 985 39 985 38 985 39 985 38 986 38 986 38 986 37 987 37 987 37 987 36 988 36 988 35 989 35 989 35 989 34 990 34 990 34 990 34 990 34 990 34 990 34 990 34 990 34 990 34 990 34 990 34 990 34 990 34 990 34 990 34 990 34 990 33 991 33 991 33 991 32 992 32 992 31 993 31 994 30 994 29 995 29 995 29 995 28 996 28 996 27 997 27 998 26 998 26 998 26 998 26 999 25 999 25 999 25 999 25 999 25 1000 24 1000 24 1001 23 1001 23 1002 23 1001 23 1002 22 1002 22 1003 22 1002 22 1003 21 1003 22 1002 22 1003 22 1002 22 1003 21 1003 22 1002 22 1003 22 1002 22 1003 22 1002 22 1002 23 1002 22 1002 23 1002 23 1001 24 1001 24 1000 25 1000 25 999 26 999 26 998 27 998 26 998 27 998 27 997 28 997 28 996 29 996 29 996 28 997 28 996 29 996 29 996 29 996 29 996 29 996 29 996 29 996 29 996 29 996 29 996 29 997 28 998 27 999 26 1000 24 1003 21 1005 19 1009 15 1013 11 1017 7 1021 3"

    #pneumo1 = "221609 13 1002 21 995 28 987 37 979 44 971 52 966 56 964 59 958 65 953 69 951 71 948 74 946 76 944 78 942 81 937 85 932 91 929 94 926 96 924 99 920 102 918 105 915 108 914 108 913 109 912 110 910 112 908 114 908 114 907 115 906 116 906 115 906 115 906 116 906 115 906 115 906 115 906 115 906 115 906 116 906 115 906 115 906 116 906 115 906 116 905 117 905 117 904 118 904 117 905 117 905 116 906 115 908 114 908 114 908 114 908 114 908 114 908 114 908 113 909 113 909 112 910 112 910 112 910 112 911 111 911 111 912 110 913 109 913 109 914 108 914 108 915 107 916 107 915 107 916 106 916 106 917 106 917 105 917 105 918 104 919 104 919 103 920 103 920 103 920 102 921 102 921 102 921 102 920 102 921 102 921 102 921 102 921 101 922 101 922 101 922 100 923 100 923 100 923 100 924 99 924 99 924 99 925 98 925 98 925 99 924 99 925 98 925 99 924 99 925 98 925 98 925 98 925 98 926 98 925 98 925 98 926 97 926 97 926 97 927 97 926 97 927 96 927 96 928 95 928 96 928 95 928 95 929 95 929 94 929 94 930 93 930 93 931 92 932 92 931 92 932 91 933 90 934 89 934 90 934 89 935 88 936 88 935 88 936 87 937 87 936 87 937 86 937 87 937 86 938 86 937 86 938 85 939 85 939 84 940 83 941 83 941 82 942 81 943 80 943 81 944 79 945 78 946 78 946 77 947 76 948 76 948 76 948 75 950 74 950 73 952 72 952 72 953 70 954 70 955 69 955 69 956 67 958 66 959 65 960 64 961 63 962 62 963 61 965 59 966 58 967 57 969 55 971 53 973 51 975 48 978 46 981 43 985 39 991 32 1000 24 1009 15 1020 4"
    #pneumo2 = "373863 11 1009 17 1003 22 1000 26 996 30 992 33 989 35 988 37 985 39 983 42 981 44 979 45 978 47 975 49 974 50 973 52 971 53 971 54 969 55 968 56 968 57 966 58 965 60 964 60 964 61 963 61 963 62 962 62 962 63 961 63 961 63 960 64 961 64 960 64 960 64 960 64 960 65 959 65 959 65 959 65 960 64 960 64 960 64 961 63 961 63 962 63 961 63 961 63 962 62 963 61 963 61 964 60 965 59 965 59 966 57 968 56 969 55 969 54 971 53 972 51 973 51 974 50 975 48 978 44 981 42 983 40 986 36 990 31 996 24 1002 15 1011 5"
    #pneumo1 = rle_decode_modified(pneumo1, (1024, 1024))
    #pneumo2 = rle_decode_modified(pneumo2, (1024, 1024))
    #pneumo1 = rle_decode(pneumo1, (1024, 1024))
    #pneumo2 = rle_decode(pneumo2, (1024, 1024))

    pn1 = "250542 11 1011 14 1009 15 1008 17 1005 20 1003 22 1002 21 1002 22 1002 21 1002 22 1001 22 1002 22 1001 22 1002 22 1002 21 1003 21 1003 20 1004 19 1005 19 1005 18 1005 19 1006 17 1007 17 1007 17 1007 16 1009 15 1009 15 1009 14 1010 14 1010 14 1011 12 1013 11 1013 11 1014 10 1015 9 1015 9 1016 8 1020 4"
    pn2 = "250542 11 1011 14 1009 15 1008 17 1005 20 1003 22 1002 21 1002 22 1002 21 1002 22 1001 22 1002 22 1001 22 1002 22 1002 21 1003 21 1003 20 1004 19 1005 19 1005 18 1005 19 1006 17 1007 17 1007 17 1007 16 1009 15 1009 15 1009 14 1010 14 1010 14 1011 12 1013 11 1013 11 1014 10 1015 9 1015 9 1016 8 1020 4"
    pn3 = "192189 13 1008 21 1002 25 997 29 994 32 992 33 991 34 1 1 988 36 988 36 988 36 988 37 987 37 987 37 987 38 987 37 988 37 987 37 988 36 989 35 990 34 991 33 994 30 996 28 998 26 999 25 999 25 999 25 999 25 999 25 998 26 997 27 997 27 996 28 995 29 995 28 996 28 995 28 996 28 995 28 996 28 996 27 997 27 996 27 997 26 997 27 996 27 997 26 997 25 998 25 998 24 999 23 1000 23 1001 21 1002 21 1002 20 1003 19 1005 17 1006 16 1007 15 1009 14 1009 14 1010 13 1010 14 1010 13 1011 13 1010 14 1010 13 1010 13 1011 13 1011 12 1011 13 1011 12 1011 13 1011 13 1011 12 1012 12 1012 11 1013 11 1013 11 1013 11 1013 11 1013 11 1014 10 1014 10 1014 10 1014 10 1014 10 1015 9 1015 9 1015 8 1016 8 1016 8 1016 7 1017 7 1017 6 1018 5 1022 2"
    pn4 = "201381 2 1021 3 1020 5 1018 6 1017 7 1016 9 1014 10 1015 10 1014 10 1014 10 1014 10 1015 9 1015 9 1015 9 1015 9 1020 4"
    pn5 = "166643 8 1011 18 1004 22 1000 26 996 30 991 34 988 36 985 40 982 43 979 47 975 50 972 53 970 56 966 59 963 60 962 12 21 29 959 11 28 26 955 11 34 24 952 11 39 21 957 5 42 20 1005 19 1005 19 1006 17 1008 15 1008 16 1007 16 1008 15 1008 16 1007 16 1007 16 1007 16 1007 17 1006 17 1007 16 1007 17 1006 17 1006 17 1007 16 1007 17 1006 17 1007 16 1007 17 1006 17 1007 16 1007 16 1008 15 1008 15 1009 14 1009 14 1009 14 1010 13 1010 13 1011 12 1012 11 1013 10 1013 10 1014 9 1015 8 1016 7 1016 7 1020 3"
    pn1 = rle_decode_modified(pn1, (1024, 1024))
    pn2 = rle_decode_modified(pn2, (1024, 1024))
    pn3 = rle_decode_modified(pn3, (1024, 1024))
    pn4 = rle_decode_modified(pn4, (1024, 1024))
    pn5 = rle_decode_modified(pn5, (1024, 1024))

    maskToTry = "325152 5 326171 16 327194 18 328217 20 329239 23 330262 24 331284 27 332306 30 333327 33 334347 38 335370 39 336392 42 337415 43 338438 44 339460 46 340483 47 341505 49 342529 49 343553 49 344576 50 345600 50 346624 50 347648 50 348672 50 349696 51 350720 51 351744 51 352768 51 353793 50 354817 50 355841 50 356865 50 357889 50 358913 50 359939 48 360964 47 361990 45 363016 43 364042 41 365056 6 365067 40 366074 16 366093 38 367095 21 367119 36 368115 28 368144 36 369138 66 370160 68 371182 70 372205 71 373227 73 374250 74 375274 74 376297 75 377320 76 378343 77 379365 79 380388 80 381410 82 382432 84 383454 86 384476 88 385497 91 386517 95 387538 98 388554 106 389575 109 390596 112 391615 117 392639 117 393663 117 394686 118 395710 118 396734 118 397758 118 398782 118 399806 118 400830 118 401854 118 402877 119 403901 119 404924 120 405948 120 406972 119 407996 119 409020 119 410044 118 411068 117 412092 116 413116 115 414140 114 415163 114 416187 114 417211 113 418235 113 419258 114 420282 114 421305 115 422329 115 423353 115 424377 114 425400 115 426424 115 427448 115 428471 115 429494 116 430514 120 431534 123 432556 125 433577 128 434599 130 435622 130 436645 131 437668 132 438691 133 439715 132 440738 133 441762 133 442786 133 443810 132 444833 133 445857 132 446881 130 447905 129 448928 129 449952 127 450976 126 452000 122 453024 122 454048 122 455072 122 456096 122 457120 122 458144 122 459168 122 460192 122 461216 123 462240 123 463264 123 464288 123 465312 124 466336 124 467360 125 468384 125 469408 125 470432 125 471456 125 472480 125 473504 125 474528 125 475552 125 476576 124 477599 125 478623 125 479647 124 480671 124 481695 123 482718 123 483742 122 484766 121 485790 120 486814 119 487837 120 488861 119 489885 118 490909 117 491933 117 492957 116 493981 113 495005 111 496029 110 497053 109 498077 108 499101 107 500125 106 501149 106 502173 106 503197 106 504221 106 505245 106 506269 106 507293 106 508317 106 509341 107 510365 107 511389 108 512413 108 513437 109 514461 110 515485 111 516509 112 517533 113 518557 114 519581 115 520605 116 521629 117 522653 118 523677 119 524701 120 525725 121 526749 121 527773 122 528797 123 529821 123 530845 124 531869 124 532893 125 533917 125 534941 125 535965 126 536989 126 538013 126 539037 126 540061 126 541085 126 542109 126 543133 126 544157 126 545181 126 546205 126 547229 126 548253 126 549277 126 550301 126 551325 126 552349 126 553373 126 554397 126 555421 126 556445 126 557469 126 558493 126 559517 126 560541 126 561565 125 562589 125 563613 125 564637 125 565661 124 566685 124 567709 124 568733 124 569757 124 570782 123 571806 123 572830 123 573854 123 574878 123 575903 121 576927 121 577951 120 578975 120 579999 120 581023 119 582047 119 583072 118 584096 117 585120 117 586144 117 587169 115 588193 115 589218 114 590242 113 591267 112 592291 112 593316 110 594340 110 595364 109 596388 109 597413 107 598437 106 599461 106 600486 104 601510 103 602535 101 603560 99 604585 98 605609 97 606634 91 607659 84 608683 72 609707 70 610732 65 611756 63 612781 61 613806 55 614831 48 615855 46 616880 44 617905 42 618929 40 619954 38 620978 37 622003 36 623028 34 624053 33 625078 32 626104 29 627129 28 628154 26 629180 24 630205 22 631235 16 632266 8 633262 3 633293 5 634280 21 634319 2 635300 26 636323 29 637345 32 638368 35 639390 38 640412 42 641433 47 642457 50 643480 52 644504 53 645527 55 646551 56 647574 58 648598 60 649621 62 650646 62 651670 63 652695 63 653719 64 654746 63 655773 61 656801 56 657828 53 658855 45 659882 38 667103 1 668122 13 669144 19 670167 26 671189 30 672212 1 672219 26 673231 40 674253 44 675275 48 676296 53 677318 57 678339 62 679360 66 680382 68 681403 72 682427 73 683451 73 684475 74 685499 43 685548 25 686525 39 686572 25 687550 35 687596 26 688577 30 688620 26 689604 24 689644 26 690639 6 690668 26 691692 26 692716 26 693740 26 694764 26 695788 26 696812 25 697836 25 698859 26 699883 26 700907 26 701930 27 702953 27 703976 28 704999 29 706022 30 707045 30 708068 31 709091 32 710114 32 711137 32 712160 33 713183 33 714205 28 715227 27 716255 20"
    maskToTry = "501985 7 503008 13 504031 16 505054 19 506077 20 507101 20 508124 21 509147 22 510170 23 511193 24 512216 25 513239 26 514262 27 515286 27 516309 28 517332 29 518355 30 519378 31 520401 32 521424 33 522447 34 523471 34 524494 35 525517 36 526540 38 527563 40 528587 41 529611 42 530635 44 531659 45 532683 47 533706 53 534730 57 535754 62 536778 65 537801 69 538825 73 539849 75 540872 79 541896 80 542920 81 543944 82 544967 84 545991 84 547015 85 548038 86 549062 87 550085 88 551109 89 552132 90 553156 90 554180 91 555203 92 556227 91 557251 89 558274 89 559298 70 560322 67 561345 67 562369 66 563393 64 564417 62 565441 60 566465 59 567489 57 568513 56 569537 55 570561 54 571585 52 572609 51 572684 16 573633 49 573698 31 574657 48 574720 35 575681 46 575742 39 576705 44 576765 42 577729 43 577787 47 578753 42 578810 49 579778 40 579832 51 580804 37 580853 55 581829 35 581876 57 582856 30 582898 60 583883 25 583921 63 584944 65 585967 67 586991 67 588014 69 589038 70 590062 71 591087 72 592111 73 593136 73 594160 75 595184 76 596208 77 597232 79 598256 80 599280 80 600304 81 601327 82 602351 83 603374 85 604398 85 605422 86 606446 86 607470 87 608493 88 609517 89 610541 89 611565 90 612590 89 613614 90 614639 91 615663 92 616688 93 617713 93 618737 95 619762 99 620787 100 621812 102 622836 104 623861 106 624886 22 624936 56 625911 12 625966 8 625982 35 626936 1 627009 33 628037 30 629064 27 630090 25 631115 24 632141 22 633166 21 634192 17 635218 14 636248 6"
    maybeThisOne = "413905 1 414928 2 415952 1 416975 2 417999 1 419022 1 420046 1 421069 1 422093 1 423116 1 424140 1 425163 1 426186 2 427210 1 428233 2 429256 2 430279 3 431303 2 432326 3 433350 2 434373 3 435397 3 436420 3 437444 3 438467 4 439491 3 440514 4 441538 3 442561 4 443585 4 444609 3 445632 4 446656 4 447679 5 448703 5 449727 5 450750 6 451774 6 452797 7 453821 7 454844 8 455868 8 456891 9 457915 9 458938 10 459962 10 460986 10 462009 11 463033 11 464056 12 465080 12 466104 12 467127 13 468151 12 469174 13 470198 13 471221 14 472245 14 473268 15 474292 15 475315 16 476339 16 477363 15 478386 16 479410 16 480433 17 481457 17 482481 17 483504 18 484528 18 485552 17 486575 18 487599 18 488622 19 489646 19 490670 19 491693 20 492717 20 493741 20 494764 20 495788 20 496811 21 497835 21 498859 21 499882 22 500906 22 501930 22 502953 22 503977 22 505000 23 506024 23 507048 23 508071 24 509095 24 510119 24 511142 25 512166 24 513189 25 514213 25 515237 25 516260 26 517284 26 518308 25 519331 26 520355 26 521378 27 522402 26 523426 26 524450 26 525473 27 526497 27 527521 26 528545 26 529568 27 530592 27 531616 26 532640 26 533664 26 534688 26 535711 26 536735 26 537759 25 538783 25 539807 25 540831 24 541855 24 542878 25 543902 24 544926 24 545950 23 546973 24 547997 24 549021 23 550045 23 551069 23 552093 22 553116 23 554140 22 555164 22 556188 22 557212 21 558236 21 559259 21 560283 21 561307 20 562330 21 563354 20 564377 21 565401 20 566425 19 567449 19 568472 19 569496 19 570520 18 571544 18 572567 18 573591 18 574615 17 575638 18 576662 17 577686 17 578709 17 579733 17 580756 17 581780 17 582804 16 583828 16 584851 16 585875 16 586899 15 587923 15 588946 15 589970 15 590994 14 592018 14 593041 14 594065 14 595089 14 596112 14 597136 14 598159 14 599183 14 600207 13 601231 13 602254 13 603278 13 604302 12 605326 12 606349 13 607373 12 608397 12 609421 11 610444 12 611468 12 612492 11 613516 11 614539 11 615563 11 616587 10 617611 10 618635 9 619658 10 620682 9 621706 9 622730 9 623753 9 624777 9 625801 8 626825 8 627848 9 628872 8 629896 8 630920 8 631943 8 632967 8 633991 8 635015 8 636039 7 637063 7 638086 8 639110 8 640134 8 641158 7 642182 7 643206 7 644230 7 645253 7 646277 7 647301 7 648325 7 649348 7 650372 7 651396 7 652420 7 653444 6 654468 6 655491 7 656515 7 657539 7 658563 7 659587 7 660611 6 661635 6 662659 6 663683 6 664706 7 665730 7 666754 7 667778 7 668802 7 669826 7 670850 7 671874 7 672897 8 673921 8 674945 8 675969 8 676993 8 678017 7 679041 7 680065 7 681089 7 682113 7 683137 7 684161 7 685185 7 686209 7 687233 7 688257 7 689281 7 690305 7 691329 7 692353 7 693377 6 694401 6 695425 6 696449 6 697473 5 698497 5 699521 5 700545 5 701569 4 702593 4 703617 4 704642 3 705666 2 706691 1 888944 1 889967 3 890991 3 892014 5 893038 6 894062 6 895085 8 896109 9 897133 10 898156 11 899180 12 900203 14 901227 15 902251 16 903275 17 904298 19 905322 21 906346 22 907370 24 908393 28 909417 30 910441 32 911465 34 912489 37 913512 47 914536 48 915560 48 916583 50 917607 50 918630 52 919654 52 920678 53 921702 54 922725 55 923749 56 924773 56 925797 57 926820 59 927844 59 928868 60 929892 61 930916 61 931939 63 932963 63 933987 64 935011 65 936035 65 937059 66 938083 66 939107 67 940131 67 941155 68 942179 68 943203 69 944228 68 945252 67 946277 66 947301 66 948326 64 949351 61 950376 59 951401 57 952426 55 953450 16 953479 25 954475 6 954513 6"
    maskToTry = "211549 10 212569 22 213589 35 214609 43 215629 51 216651 62 217673 68 218695 74 219717 80 220740 86 221762 91 222785 94 223807 99 224830 103 225853 106 226875 111 227898 115 228920 119 229943 123 230966 125 231989 128 233012 130 234035 133 235058 135 236081 138 237104 141 238128 143 239151 146 240174 148 241197 151 242221 152 243244 155 244268 156 245291 158 246315 160 247338 162 248362 164 249385 166 250409 167 251432 170 252456 171 253480 173 254503 175 255527 176 256551 178 257575 179 258598 182 259622 183 260646 184 261670 186 262694 187 263718 189 264741 115 264881 51 265765 111 265909 48 266789 107 266937 46 267813 104 267966 42 268837 102 268994 40 269861 99 270021 38 270885 97 271047 37 271908 96 272074 36 272932 94 273101 34 273956 92 274127 34 274980 91 275154 32 276003 90 276181 30 277027 89 277207 29 278051 87 278234 28 279075 86 279260 27 280099 85 280286 26 281123 83 281311 26 282146 83 282337 25 283170 81 283362 25 284194 80 284388 25 285218 79 285413 25 286242 77 286439 24 287266 76 287464 24 288290 74 288490 23 289314 73 289515 23 290338 72 290541 23 291361 71 291566 23 292385 70 292592 22 293409 68 293617 22 294433 67 294642 22 295457 66 295668 22 296481 65 296693 22 297505 64 297718 22 298529 63 298743 22 299553 62 299768 22 300576 62 300794 21 301600 60 301819 20 302624 58 302844 20 303648 56 303869 20 304672 54 304894 20 305696 51 305919 20 306720 49 306945 19 307744 46 307970 18 308768 45 308995 18 309792 43 310020 18 310816 42 311045 18 311840 40 312071 17 312864 39 313096 16 313888 38 314121 16 314912 37 315146 16 315936 35 316171 16 316960 34 317196 15 317984 33 318221 15 319008 32 319246 15 320032 31 320271 14 321056 29 321296 14 322080 28 322321 14 323104 27 323345 15 324128 26 324370 14 325152 25 325395 14 326176 24 326420 14 327200 23 327444 14 328224 22 328469 14 329248 21 329494 13 330272 20 330518 14 331296 18 331543 14 332320 16 332568 13 333345 13 333593 13 334369 11 334617 13 335394 9 335642 13 336418 7 336667 12 337443 5 337692 11 338467 3 338717 10 339492 1 339742 10 340767 9 341792 1 435402 1 436425 10 437449 12 438472 14 439495 17 440518 20 441542 22 442565 25 443589 27 444612 30 445636 33 446660 35 447683 39 448707 41 449730 44 450754 46 451778 48 452802 50 453825 53 454849 55 455873 57 456897 58 457920 61 458944 62 459968 64 460992 65 462016 66 463040 67 464063 69 465087 70 466111 71 467135 72 468159 73 469183 73 470207 74 471231 75 472255 76 473278 77 474302 78 475326 79 476350 79 477374 80 478398 81 479421 83 480445 83 481469 84 482493 85 483516 86 484540 87 485564 87 486588 88 487612 88 488635 90 489659 90 490683 91 491707 91 492730 93 493754 93 494778 94 495801 95 496825 96 497849 96 498872 98 499896 98 500919 100 501943 100 502967 101 503991 101 505014 103 506038 103 507062 103 508086 104 509109 105 510133 105 511157 105 512181 106 513205 106 514228 107 515252 107 516276 108 517300 108 518323 109 519347 109 520371 110 521395 110 522418 111 523442 111 524466 111 525490 111 526513 111 527537 111 528561 111 529585 111 530609 111 531633 111 532656 112 533680 112 534704 112 535728 111 536752 111 537776 111 538800 111 539823 112 540847 112 541871 111 542895 111 543918 111 544942 111 545966 111 546990 110 548013 111 549037 111 550061 110 551085 110 552108 111 553132 111 554156 110 555180 110 556204 110 557227 111 558251 110 559275 110 560299 109 561322 110 562346 110 563370 109 564394 109 565417 110 566441 110 567465 109 568489 109 569512 110 570536 110 571560 109 572584 109 573608 109 574632 109 575656 108 576679 109 577703 109 578727 109 579751 108 580775 108 581799 108 582823 108 583847 107 584870 108 585894 108 586918 108 587942 107 588966 107 589990 107 591014 107 592038 106 593062 106 594085 106 595109 106 596133 106 597157 105 598181 105 599205 105 600229 104 601253 104 602276 105 603300 104 604324 104 605348 104 606372 103 607396 103 608420 103 609444 102 610468 102 611491 103 612515 103 613539 102 614563 102 615587 102 616611 102 617635 101 618659 101 619683 101 620707 101 621731 100 622755 100 623779 100 624803 100 625827 99 626851 99 627876 98 628900 97 629924 97 630948 97 631972 96 632996 96 634020 96 635044 96 636068 96 637092 95 638116 95 639140 95 640164 95 641188 95 642212 95 643236 95 644260 95 645284 94 646308 94 647332 94 648356 94 649380 94 650404 94 651428 94 652452 94 653476 94 654501 94 655525 94 656549 94 657573 94 658597 94 659622 93 660646 92 661671 91 662695 19 662726 59 663720 15 663754 55 664744 13 664786 47 665769 9 665819 37 666793 1 666852 28 667886 10 730333 1 731353 13 732372 22 733395 27 734418 29 735440 33 736463 35 737486 38 738509 40 739532 41 740556 41 741579 43 742602 44 743626 44 744649 45 745673 46 746696 47 747720 45 748743 44 749767 43 750790 42 751816 32 752843 20 753869 1"
    maskToTry = "391356 1 392380 2 393403 4 394427 5 395450 7 396474 8 397497 9 398521 9 399544 11 400568 11 401592 11 402615 12 403639 13 404663 13 405687 13 406710 15 407734 15 408758 15 409782 15 410806 16 411830 16 412853 17 413877 17 414901 18 415925 18 416949 18 417973 18 418997 19 420021 19 421045 19 422068 21 423092 21 424116 22 425140 22 426164 23 427188 23 428212 24 429236 25 430260 26 431284 26 432308 27 433332 27 434356 27 435380 28 436404 28 437428 28 438452 28 439476 29 440500 29 441524 29 442548 29 443572 30 444596 30 445620 30 446644 30 447669 30 448693 30 449717 30 450741 30 451765 31 452789 31 453813 31 454837 32 455861 32 456885 33 457909 33 458933 33 459957 34 460981 34 462005 34 463029 35 464053 35 465077 36 466101 36 467125 36 468149 37 469173 37 470197 37 471221 38 472245 38 473269 39 474293 39 475317 39 476341 40 477365 40 478389 40 479413 41 480437 41 481461 42 482485 42 483509 42 484533 43 485557 43 486581 44 487605 44 488629 45 489653 45 490677 46 491701 47 492724 48 493748 49 494772 49 495796 50 496820 50 497844 51 498868 51 499892 52 500915 53 501939 54 502963 54 503987 55 505011 55 506035 56 507059 57 508083 57 509107 58 510131 59 511155 60 512179 60 513203 61 514227 62 515251 62 516275 63 517299 63 518323 64 519347 64 520371 65 521395 65 522419 66 523443 66 524468 65 525492 66 526517 65 527541 65 528565 66 529590 65 530614 65 531639 64 532664 63 533689 61 534713 61 535738 60 536763 59 537788 58 538813 55 539838 52 540864 48 541889 45 542914 40 543947 27 544980 9 603360 5 604378 13 605401 16 606424 18 607447 20 608470 22 609493 25 610516 28 611539 31 612563 32 613586 34 614610 36 615633 38 616657 39 617681 40 618705 42 619729 43 620753 44 621777 45 622801 45 623825 46 624849 47 625873 48 626897 48 627921 49 628944 50 629968 51 630992 52 632016 52 633040 53 634063 55 635087 56 636111 56 637135 57 638159 58 639183 59 640207 60 641231 61 642255 62 643280 62 644304 64 645329 64 646353 65 647378 65 648402 66 649427 66 650451 68 651476 68 652500 70 653525 70 654549 71 655573 72 656597 73 657621 74 658645 75 659669 78 660694 80 661718 82 662743 83 663767 84 664792 84 665816 85 666841 85 667866 84 668891 84 669972 27 671005 19 672033 16 673065 8 674097 1"
    maskToTry = "66942 10 67958 22 68973 35 69989 52 71009 59 72028 66 73049 72 74071 78 75092 85 76114 91 77136 98 78158 103 79180 107 80202 112 81225 117 82247 123 83269 126 84292 129 85315 131 86338 134 87360 137 88383 138 89406 140 90429 141 91451 144 92474 145 93496 148 94519 149 95542 151 96565 152 97587 155 98610 156 99633 157 100656 159 101679 160 102702 162 103724 164 104747 165 105770 166 106793 168 107816 169 108839 170 109862 171 110885 173 111908 174 112931 175 113954 177 114977 178 116000 179 117023 181 118046 182 119069 184 120092 185 121115 186 122139 186 123162 187 124185 188 125208 190 126231 191 127254 192 128277 193 129300 141 129466 26 130323 125 130499 14 131346 118 131531 4 132369 110 133392 108 134416 106 135439 104 136462 101 137485 98 138508 94 139531 91 140554 89 141577 88 142600 86 143623 85 144646 84 145669 83 146692 82 147716 80 148739 79 149762 79 150785 78 151808 77 152831 76 153854 75 154877 74 155900 73 156923 72 157947 70 158970 69 159994 68 161017 68 162041 66 163064 66 164088 65 165111 65 166134 65 167158 64 168181 65 169204 65 170227 65 171251 64 172274 64 173298 63 174321 62 175345 61 176368 61 177392 60 178415 60 179439 58 180462 58 181486 57 182509 57 183533 56 184556 56 185580 55 186603 55 187627 54 188651 53 189674 53 190698 51 191721 51 192745 49 193768 49 194792 48 195815 48 196839 47 197862 47 198886 46 199909 46 200933 45 201956 45 202980 44 204003 44 205027 43 206050 43 207074 42 208097 42 209121 41 210144 41 211168 40 212191 40 213214 40 214238 39 215261 39 216285 38 217308 38 218332 37 219355 37 220379 36 221402 36 222426 36 223449 36 224473 35 225496 35 226520 34 227543 35 228566 35 229590 34 230613 34 231636 35 232659 35 233683 34 234706 35 235729 35 236753 35 237776 35 238800 35 239823 35 240847 34 241870 35 242894 34 243917 35 244941 34 245964 35 246988 34 248011 35 249035 34 250058 35 251082 34 252105 35 253129 34 254152 35 255176 34 256199 35 257223 34 258246 35 259270 34 260293 35 261317 34 262341 34 263364 34 264388 33 265411 34 266435 33 267459 33 268482 33 269506 33 270530 32 271553 33 272577 32 273600 33 274624 32 275648 32 276671 32 277695 32 278719 31 279742 31 280766 31 281789 31 282813 30 283837 30 284861 29 285884 30 286908 29 287932 28 288956 28 289979 28 291003 28 292027 27 293051 27 294074 27 295098 26 296122 26 297146 25 298169 25 299193 24 300217 24 301241 23 302264 23 303288 23 304312 22 305335 22 306359 21 307382 22 308406 21 309430 20 310453 19 311477 18 312501 16 313524 16 314548 15 315571 15 316595 14 317619 14 318643 13 319666 13 320690 12 321714 11 322738 11 323761 11 324785 10 325809 9 326833 9 327856 9 328880 8 329904 7 330928 6 331951 6 332975 5 333999 4 335023 3 336046 4 337070 3 338094 2 339118 1 340141 2 341165 1 628864 1 629888 1 630912 1 631936 1 632959 2 633983 2 635007 2 636031 3 637055 3 638079 3 639103 3 640127 3 641150 4 642174 4 643198 4 644222 4 645246 4 646270 4 647294 4 648318 4 649341 5 650365 5 651389 5 652413 5 653437 5 654461 5 655485 5 656509 5 657532 6 658556 6 659580 6 660604 6 661628 6 662652 6 663676 6 664700 6 665723 7 666747 7 667771 7 668795 7 669819 7 670843 7 671867 7 672891 7 673914 8 674938 8 675962 8 676986 8 678010 8 679034 8 680058 8 681082 8 682105 9 683129 9 684153 9 685177 9 686201 9 687225 9 688249 9 689273 9 690296 10 691320 10 692344 10 693368 10 694392 10 695416 10 696440 10 697464 10 698487 11 699511 10 700535 10 701559 10 702583 10 703607 10 704631 10 705655 10 706679 10 707703 10 708727 10 709751 10 710775 10 711799 10 712823 9 713847 9 714871 9 715895 9 716919 9 717943 9 718966 10 719990 10 721014 9 722038 9 723061 9 724085 9 725109 9 726133 9 727156 10 728180 10 729203 11 730227 11 731251 11 732274 13 733298 13 734322 13 735346 13 736370 13 737393 14 738417 14 739441 14 740465 14 741488 15 742512 15 743536 15 744560 15 745584 14 746608 14 747632 14 748656 14 749680 14 750703 15 751727 15 752751 15 753775 15 754799 15 755823 15 756847 15 757871 15 758895 14 759919 14 760943 14 761967 14 762991 14 764015 14 765039 14 766063 14 767087 14 768111 14 769135 14 770159 14 771183 14 772207 14 773230 14 774254 14 775278 14 776302 14 777326 14 778350 14 779374 14 780398 14 781422 14 782445 15 783469 15 784493 15 785517 15 786541 15 787565 15 788589 15 789613 15 790637 15 791660 16 792684 16 793708 16 794732 16 795756 15 796780 15 797804 15 798828 14 799853 13 800877 12 801901 12 802925 11 803949 11 804973 10 805997 10 807021 9 808045 9 809069 8 810093 8 811117 8 812141 7 813165 7 814189 6 815213 6 816237 6 817261 5 818285 5 819309 5 820333 4 821357 4 822381 3 823404 4 824428 4 825452 3 826477 2 827501 1 828525 1"

    target = "39074 18 39546 32 40022 38 40498 45 40975 50 41453 53 41932 55 42410 59 42888 62 43366 66 43845 68 44324 70 44803 72 45282 73 45761 75 46240 77 46718 80 47198 38 47241 37 47677 33 47723 36 48156 28 48205 34 48635 26 48687 32 49114 25 49168 31 49593 23 49650 29 50073 21 50131 28 50551 19 50614 24 51031 17 51096 22 51510 16 51577 20 51989 16 52059 18 52469 15 52541 15 52948 14 53022 14 53427 14 53504 12 53905 15 53986 9 54384 15 54468 6 54863 14 54949 5 55342 14 55821 14 56300 14 56779 14 57258 13 57737 13 58216 13 58695 13 59175 12 59654 12 60133 11 60612 12 61091 12 61570 11 62049 11 62529 10 63008 11 63488 10 63968 9 64447 9 64926 9 65406 9 65885 9 66365 8 66844 9 67324 8 67803 9 68282 9 68762 8 69242 7 69721 8 70201 8 70681 7 71160 7 71640 6 72119 7 72599 6 73078 6 73558 6 74038 5 74517 6 74997 5 75476 5 75955 6 76435 6 76914 6 77394 6 77873 6 78353 6 78833 6 79312 6 79792 6 80271 7 80751 6 81231 6 81711 6 82190 7 82670 6 83149 7 83629 6 84109 6 84589 5 85068 6 85548 6 86028 6 86508 5 86987 6 87467 6 87947 5 88427 5 88907 4 89387 4 89867 4 90347 4 90826 4 91306 4 91786 4 92266 4 92746 4 93226 4 93706 4 94186 3 94666 3 95146 3 95626 3 96106 3 96586 3 97066 3 97546 3 98026 3 98505 4 98985 4 99465 4 99945 3 100425 3 100905 3 101385 3 101865 3 102344 4 102824 4 103304 5 103784 5 104263 7 104743 7 105223 7 105703 8 106183 8 106663 8 107143 8 107623 9 108103 9 108583 9 109063 8 109543 8 110024 7 110504 7 110984 7 111464 7 111944 6 112424 6 112904 6 113384 6 113864 6 114344 6 114824 6 115304 6 115784 6 116264 6 116744 6 117224 6 117704 6 118184 5 118664 5 119144 5 119623 6 120103 6 120583 6 121063 6 121543 6 122022 7 122502 5 122982 5 123462 4 123942 4 124421 5 124901 4 125381 4 125860 4 126340 4 126820 4 127300 4 127780 3 128260 3 128740 3 129220 2 129701 1"
    target = "33883 15 34355 26 34831 34 35309 39 35787 42 36264 47 36743 50 37223 51 37702 53 38181 55 38660 56 39140 57 39618 61 40098 62 40577 64 41056 66 41536 67 42016 68 42495 70 42975 71 43454 73 43934 74 44413 76 44893 77 45372 79 45852 79 46331 81 46811 83 47290 85 47770 86 48249 88 48729 89 49208 91 49688 91 50168 92 50648 94 51128 95 51607 97 52087 97 52567 98 53047 99 53526 100 54006 101 54486 102 54966 103 55446 104 55926 105 56406 105 56885 107 57365 108 57845 109 58325 109 58805 110 59285 110 59765 60 59830 46 60245 57 60316 40 60725 55 60800 37 61205 53 61284 33 61685 50 61768 30 62165 42 62250 28 62645 33 62731 28 63125 31 63213 26 63605 28 63695 25 64085 26 64177 23 64565 24 64658 23 65045 21 65140 21 65525 20 65621 20 66005 19 66102 19 66485 18 66583 19 66965 17 67064 18 67445 16 67545 17 67925 15 68026 16 68405 14 68507 16 68885 13 68988 15 69365 13 69469 15 69845 12 69950 14 70326 11 70430 14 70806 11 70911 14 71286 10 71392 13 71766 10 71873 13 72246 10 72354 12 72727 8 72835 12 73207 8 73315 12 73687 7 73796 11 74168 6 74277 10 74648 5 74758 10 75130 2 75238 10 75719 9 76200 9 76680 9 77161 8 77641 8 78122 8 78602 8 79083 7 79564 7 80045 6 80526 5 81007 4 81487 5 81968 4 82448 4 82929 3 83410 3 83890 3 84371 2 84851 2"
    target = "75076 5 75553 10 76032 12 76511 13 76989 16 77468 17 77947 19 78425 21 78904 22 79382 25 79862 25 80342 26 80822 27 81302 27 81782 27 82262 27 82743 27 83223 27 83703 28 84184 27 84664 27 85144 27 85625 26 86105 26 86587 24 87068 23 87548 23 88030 21 88511 20 88992 19 89473 18 89955 15 90437 13 90920 8"
    #original1 = "182762 23 924 25 44 33 913 114 904 122 898 127 894 131 891 135 887 138 884 141 881 144 881 144 881 144 881 143 882 143 882 143 884 141 887 137 890 134 894 130 898 126 902 122 905 119 907 117 909 115 911 114 911 113 912 112 914 110 917 107 921 103 925 99 929 95 933 91 936 89 937 87 940 84 943 81 945 79 948 76 951 73 953 71 956 68 959 64 962 62 965 59 967 57 969 55 971 53 972 52 974 50 976 48 978 45 981 43 983 41 985 39 987 36 989 35 991 33 992 32 993 30 996 28 997 26 1000 24 1002 21 1005 19 1007 16 1011 13 1014 5"
    #original2 = "211564 9 1010 16 995 31 991 35 987 39 984 42 981 50 973 53 970 56 967 59 964 61 962 63 961 64 960 64 960 64 960 64 960 64 959 65 959 65 959 65 959 65 959 65 960 64 960 64 961 63 961 63 962 62 963 61 964 60 965 59 965 59 966 58 966 58 967 57 967 57 968 56 969 55 970 54 970 54 971 53 972 52 973 51 974 50 974 50 975 49 976 48 977 47 979 45 980 44 981 43 983 41 985 39 986 38 988 36 989 35 990 34 992 32 993 31 994 30 995 29 996 28 997 27 998 26 999 25 999 25 1000 24 1001 23 1002 22 1003 21 1004 21 1004 20 1004 20 1005 19 1006 18 1006 18 1007 17 1008 16 1009 15 1010 15 1010 14 1011 13 1012 12 1012 13 1011 13 1012 12 1012 12 1012 12 1013 11 1013 11 1014 10 1014 11 1014 10 1015 9 1016 8 1017 7 1019 5 1021 3 1022 2 1024 1"
    #original3 = "222822 5 1017 13 1008 18 1004 20 1002 22 1000 24 998 26 997 27 997 27 996 28 995 29 995 30 993 31 992 32 992 32 991 34 991 33 991 33 991 33 991 34 991 33 991 33 991 33 991 33 992 32 992 32 992 32 993 31 993 32 993 30 994 30 994 30 995 29 997 26 999 25 1000 24 1002 22 1003 20 1005 18 1007 16 1009 13 1012 11 1014 9"
    #pneumo_tot = rle_decode_modified(original3, (1024, 1024))
    target = "153187 19 154203 31 155218 44 156234 56 157254 64 158273 72 159294 78 160316 83 161337 88 162360 90 163382 94 164405 97 165427 100 166450 102 167473 105 168496 107 169519 109 170543 110 171566 112 172589 114 173612 116 174635 118 175658 120 176682 121 177705 123 178728 125 179751 128 180774 130 181798 131 182821 133 183844 135 184867 137 185891 138 186914 140 187938 141 188961 143 189985 144 191008 146 192032 147 193055 149 194079 150 195102 152 196126 153 197149 155 198173 156 199196 158 200220 159 201243 161 202267 162 203290 164 204314 164 205337 166 206361 167 207384 169 208408 170 209431 172 210455 173 211479 174 212502 176 213526 177 214549 179 215573 180 216596 182 217620 183 218643 185 219667 186 220690 188 221714 189 222738 190 223761 192 224785 193 225809 194 226832 196 227856 197 228880 198 229904 199 230927 201 231951 202 232975 203 233999 204 235022 206 236046 206 237070 207 238094 208 239117 210 240141 211 241165 211 242189 212 243212 214 244236 215 245260 215 246284 216 247308 217 248332 218 249355 219 250379 220 251403 221 252427 222 253451 223 254475 224 255499 225 256523 225 257547 226 258570 228 259594 229 260618 230 261642 230 262666 231 263690 231 264714 232 265738 232 266761 234 267785 235 268809 235 269833 236 270857 236 271881 128 272021 97 272905 124 273053 90 273929 122 274082 85 274953 120 275110 82 275977 118 276138 78 277001 116 277166 75 278025 114 278194 71 279049 112 279222 67 280073 110 280248 66 281097 108 281274 64 282121 100 282300 63 283145 91 283326 61 284169 74 284352 59 285193 71 285378 58 286217 69 286404 56 287241 66 287430 55 288265 63 288456 53 289289 61 289482 52 290313 58 290507 51 291337 56 291533 50 292361 54 292558 49 293385 52 293584 48 294409 50 294609 47 295433 48 295635 45 296457 46 296660 45 297481 45 297685 44 298505 43 298710 44 299529 42 299736 42 300553 41 300761 41 301578 38 301786 40 302602 37 302811 40 303626 36 303836 39 304650 35 304861 38 305674 34 305886 37 306698 33 306911 37 307722 32 307936 36 308746 31 308961 35 309770 30 309986 35 310794 29 311011 34 311818 29 312036 33 312842 28 313060 34 313866 28 314085 33 314890 27 315110 33 315914 27 316135 32 316938 27 317160 31 317962 26 318185 31 318986 26 319209 31 320011 25 320234 30 321035 24 321259 30 322059 24 322284 29 323083 23 323309 29 324107 23 324334 28 325131 23 325359 27 326156 21 326383 28 327180 21 327408 27 328204 20 328433 26 329228 20 329458 26 330253 18 330483 25 331277 18 331508 25 332301 17 332533 24 333325 17 333557 24 334350 15 334582 23 335374 15 335607 23 336399 13 336632 22 337423 13 337656 22 338447 12 338681 21 339472 10 339706 21 340496 9 340731 20 341524 5 341755 20 342551 1 342780 20 343805 19 344829 19 345854 19 346878 19 347903 19 348927 19 349952 18 350976 19 352001 18 353025 18 354050 18 355075 17 356100 16 357124 17 358149 16 359174 15 360198 15 361223 15 362248 14 363273 13 364297 13 365322 13 366347 12 367372 11 368397 10 369421 11 370446 10 371471 9 372496 8 373521 8 374545 8 375570 7 376594 7 377619 6 378643 7 379668 6 380693 5 381717 5 382742 5 383766 5 384791 3 385815 3 386840 1 387864 1"
    prediction = "159323 12 160336 38 161351 56 162372 62 163391 70 164414 76 165436 81 166458 86 167480 91 168503 95 169524 99 170547 102 171569 105 172591 109 173614 111 174637 113 175659 117 176682 120 177705 122 178728 124 179751 126 180774 128 181797 129 182821 131 183844 132 184867 134 185890 136 186913 137 187936 139 188959 141 189983 141 191006 143 192030 144 193054 145 194077 147 195101 148 196125 149 197148 152 198172 153 199196 154 200220 156 201244 157 202268 158 203291 160 204315 161 205339 163 206362 165 207386 166 208409 168 209433 169 210456 171 211480 172 212503 174 213527 175 214551 177 215574 179 216598 180 217622 180 218645 182 219669 183 220692 185 221716 186 222740 187 223763 189 224787 190 225811 191 226834 192 227858 193 228882 194 229905 196 230929 197 231953 197 232977 198 234000 200 235024 200 236048 201 237072 202 238095 203 239119 203 240143 204 241167 205 242191 205 243215 206 244239 207 245263 207 246287 208 247310 210 248334 211 249358 212 250381 215 251405 216 252429 217 253453 218 254477 219 255500 221 256524 222 257548 223 258572 223 259595 225 260619 226 261643 226 262667 227 263690 229 264714 229 265738 230 266762 230 267785 232 268809 232 269833 233 270857 233 271881 233 272905 45 272951 101 273057 82 273929 42 273977 21 274042 7 274059 9 274084 79 274953 39 275003 14 275111 77 275977 37 276032 1 276138 74 277001 35 277167 69 278025 33 278192 69 279049 32 279219 67 280073 31 280245 65 281097 29 281271 64 282121 29 282297 63 283145 27 283324 60 284170 26 284350 59 285194 24 285376 57 286218 23 286401 57 287244 20 287426 56 288268 19 288452 54 289293 16 289478 53 290318 9 290503 52 291529 51 292555 49 293582 47 294607 46 295632 45 296657 45 297683 43 298707 43 299733 42 300758 41 301783 40 302808 39 303833 39 304858 38 305883 38 306909 36 307934 36 308959 35 309984 34 311009 34 312034 33 313059 33 314085 31 315110 30 316135 30 317159 31 318184 30 319209 29 320234 29 321259 28 322284 27 323309 27 324334 27 325359 26 326383 27 327408 26 328433 26 329458 25 330483 25 331508 24 332533 23 333557 24 334582 23 335607 23 336632 22 337656 22 338681 22 339706 21 340730 21 341755 20 342780 20 343804 20 344829 20 345854 19 346878 20 347903 19 348928 18 349952 18 350977 17 352002 16 353026 17 354051 16 355076 15 356100 16 357125 15 358150 14 359175 13 360199 14 361224 13 362248 13 363273 12 364298 12 365322 12 366346 12 367371 11 368395 11 369420 10 370444 10 371468 11 372493 10 373517 10 374541 10 375566 9 376590 9 377614 9 378638 9 379663 8 380687 8 381711 8 382736 7 383760 7 384784 7 385809 6 386833 6 387858 5 388882 5 389906 5 390930 5 391954 5 392979 4 394003 4 395027 4 396051 4 397075 3 398100 2 399124 2"
    img_name = "3.5.42.942629.53.2.0.6.90921253161.7144624509648.6"

    #prediction = "38593 12 39070 26 39546 37 40023 42 40500 48 40978 52 41456 55 41934 59 42413 61 42891 64 43370 66 43848 69 44326 72 44804 75 45283 76 45761 79 46240 81 46718 84 47197 85 47676 46 47727 35 48155 43 48210 33 48634 42 48692 31 49113 40 49173 29 49592 38 49654 28 50071 35 50136 26 50550 35 50618 24 51029 34 51101 20 51508 34 51583 17 51987 32 52068 12 52466 29 52552 7 52945 27 53033 5 53425 25 53515 1 53904 22 54383 20 54862 19 55341 18 55820 17 56299 16 56778 16 57258 14 57737 14 58216 14 58695 14 59174 14 59653 14 60132 14 60612 13 61091 14 61570 14 62049 15 62529 14 63008 13 63488 12 63967 13 64446 12 64926 11 65405 11 65885 10 66365 8 66845 7 67324 6 67804 5 68285 2"
    #prediction = "35318 26 35792 36 36269 41 36747 45 37226 48 37704 52 38183 54 38662 57 39141 59 39620 61 40099 62 40579 63 41058 65 41538 66 42017 68 42497 69 42976 71 43456 72 43936 73 44416 74 44895 76 45375 77 45854 79 46334 80 46813 82 47293 83 47772 85 48251 87 48731 88 49210 90 49690 91 50169 93 50649 94 51128 96 51608 96 52087 98 52567 98 53047 99 53527 99 54006 101 54486 101 54966 102 55446 102 55925 104 56405 105 56885 105 57365 105 57845 106 58324 107 58804 108 59284 108 59764 109 60243 110 60723 111 61203 112 61683 56 61746 5 61752 43 62163 54 62237 39 62643 36 62691 2 62719 37 63122 35 63201 36 63602 33 63684 33 64082 32 64168 30 64562 30 64651 28 65042 27 65133 26 65522 24 65615 25 66003 21 66097 23 66483 20 66578 22 66963 18 67059 22 67444 15 67540 21 67925 12 68021 21 68406 10 68502 20 68983 19 69464 19 69945 18 70426 18 70907 17 71388 16 71869 16 72350 15 72831 14 73312 14 73793 13 74274 12 74755 11 75236 11 75717 10 76198 9 76678 10 77159 9 77640 8 78121 8 78602 7 79082 7 79562 7 80043 6 80523 7 81004 6 81485 5 81965 5 82445 6 82926 5 83406 6 83886 6 84367 5 84847 5 85327 5 85807 5 86287 5 86768 4 87248 4 87729 3 88210 2 88690 2 89170 2 89651 1 90131 1 90611 1"
    #prediction = "49640 16 50116 22 50592 28 51070 31 51547 35 52024 39 52501 43 52979 46 53457 49 53933 54 54410 57 54886 62 55364 64 55841 68 56319 70 56797 21 56827 43 57274 20 57312 38 57753 17 57797 33 58231 16 58280 30 58710 15 58763 28 59188 14 59245 26 59666 13 59726 25 60145 12 60207 24 60625 10 60688 23 61103 10 61170 21 61582 9 61651 20 62060 10 62132 19 62540 8 62613 18 63019 7 63094 17 63498 6 63575 16 63978 5 64056 15 64458 2 64537 13 64938 1 65018 12 65499 11 65980 9 66461 8 66942 6 67423 5 67905 3 151766 1 152245 2 152725 2 153205 3 153684 4 154164 4 154643 6 155122 7 155602 8 156081 9 156561 10 157041 10 157520 12 158000 13 158479 14 158959 15 159438 16 159918 17 160398 17 160877 20 160940 3 161357 21 161418 5 161837 22 161897 7 162317 24 162376 9 162796 26 162855 8 163276 27 163334 7 163756 28 163809 10 164236 29 164285 13 164715 31 164762 13 165195 33 165238 16 165675 37 165715 18 166155 58 166634 57 167114 54 167594 52 168074 51 168554 49 169033 48 169513 46 169993 44 170473 43 170953 41 171432 40 171912 39 172392 37 172872 35 173352 33 173832 32 174312 30 174791 30 175271 28 175751 27 176231 25 176711 24 177191 21 177671 19 178151 18 178631 17 179111 16 179591 14 180070 14 180550 13 181030 12 181510 11 181990 9 182470 8 182950 7 183430 6 183911 4 184392 3 184873 1"
    #target = rle_decode(target, (480, 480))
    #prediction = rle_decode(prediction, (480, 480))
    #target = resize_array(target, (1024, 1024))
    #prediction = resize_array(prediction, (1024, 1024))
    #pneumo_tot = pn1 + pn2 + pn3 + pn4 + pn5
    target = rle_decode(target, (1024,1024))
    prediction = rle_decode(prediction, (1024,1024))
    #pneumo_tot[pneumo_tot > 1] = 1

    #pneumo_added = pneumo1# + pneumo2

    #test_rle = mask2rle(pneumo_tot)

    #print(f"test rle: {test_rle}")
    #pneumo_tot = rle_decode(test_rle, (1024, 1024))


    # segmentation_mask_org = np.uint8(mask1)
    #mask2 = rle_decode_modified(rib1, (1024, 1024))
    #mask3 = rle_decode_modified(rib2, (1024, 1024))
    #mask4 = rle_decode_modified(rib3, (1024, 1024))
    #mask5 = rle_decode_modified(tube, (1024, 1024))
    #mask_tot = mask1 + mask2 + mask3 + mask4 + (mask5 * 3)

    data_path = "Z:/public_datasets/candid_ptx/dataset1/dataset/"
    """
    img_name = "3.2.87.981173.70.6.2.1.401987205424296.3682398659895.5"
    img_name = "2.8.23.597434.19.0.7.2.05250926090.1548912238334.2"
    img_name = "3.7.30.155952.16.5.6.2.933570534660747.9104634003282.9"
    img_name = "1.9.96.884946.46.5.6.1.530644516052689.7921761695164.6"
    img_name = "8.8.59.809437.07.5.8.2.90868453144.4406441610588.9"
    img_name = "6.3.10.421233.42.9.0.4.93195547711.8825613185488.7"
    img_name = "3.5.42.942629.53.2.0.6.90921253161.7144624509648.6"
    img_name = "0.3.88.422901.12.3.9.5.676229490377994.1333295591027.5"
    """
    img_path = os.path.join(data_path, img_name)
    DCM_Img = pdcm.read_file(img_path)
    img_raw = DCM_Img.pixel_array
    img_raw = img_raw * (255 / np.amax(img_raw))  # puts the highest value at 255
    img_raw = np.uint8(img_raw)

    f, ax = plt.subplots(1, 3)
    ax[0].imshow(img_raw, cmap=plt.cm.bone)
    ax[0].set_title('Chest X-ray', size=20)
    ax[1].imshow(target, cmap=plt.cm.bone)
    ax[1].imshow(img_raw, cmap=plt.cm.bone, alpha=.5)
    ax[1].set_title('Target Segmentation', size=20)
    ax[2].imshow(prediction, cmap="jet", alpha=1)
    # ax[2].title.set_text('Segmentation on X-Ray', size=10)
    ax[2].set_title('Model Segmentation on X-Ray', size=20)
    ax[2].imshow(img_raw, cmap=plt.cm.bone, alpha=.5)

    ax[0].axes.xaxis.set_visible(False)
    ax[0].axes.yaxis.set_visible(False)
    ax[1].axes.xaxis.set_visible(False)
    ax[1].axes.yaxis.set_visible(False)
    ax[2].axes.xaxis.set_visible(False)
    ax[2].axes.yaxis.set_visible(False)
    plt.show()

def resize_array(input_array, target_shape):
    # Calculate zoom factors for each dimension
    zoom_factors = (np.array(target_shape) / np.array(input_array.shape)).tolist()

    # Resize the input array using zoom
    resized_array = zoom(input_array, zoom_factors, order=3)  # Using cubic interpolation (order=3)

    return resized_array


def make_plots_for_all_models(img_name, seed, lavt_cnt, con_cnt):
    #img_name = "3.5.42.942629.53.2.0.6.90921253161.7144624509648.6"
    #img_name = "8.2.871.805351.9.703.0.9967444461.1812958023.411720"
    #img_name = "7.0.31.925295.30.8.2.1.086175070283447.4416060742930.8"
    #seed = 915
    # dir_base = "/UserData/"
    dir_base = "Z:/"
    target_path_base = os.path.join(dir_base, "Zach_Analysis/result_logs/candid_result/image_text_segmentation_for_paper/higher_res_for_paper/")

    target_location_res_unet = "basic_unet_from_smp_v34/seed" + str(seed) + "/prediction_dataframe_seed" + str(seed) + ".xlsx"
    target_location_unet = "baseline_unet_positive_cases_vision_larger_img_v20/seed" + str(seed) + "/prediction_dataframe_seed" + str(seed) + ".xlsx"
    target_location_contextual_net = "language_att_no_text_aug_larger_img_v24/seed" + str(seed) + "/prediction_dataframe_seed" + str(seed) + ".xlsx"
    target_location_gloria = "gloria_image_encoder_v36/seed" + str(seed) + "/prediction_dataframe_seed" + str(seed) + ".xlsx"
    target_lavt = "Z:/Zach_Analysis/result_logs/candid_result/image_text_segmentation_for_paper/higher_res_for_paper/LAVT_v50/prediction_dataframe_seed" + str(seed) + ".xlsx"
    res_unet_path = os.path.join(target_path_base, target_location_res_unet)
    unet_path = os.path.join(target_path_base, target_location_unet)
    contextual_path = os.path.join(target_path_base, target_location_contextual_net)
    gloria_path = os.path.join(target_path_base, target_location_gloria)
    lavt_path = os.path.join(target_path_base, target_lavt)

    df_res_unet = pd.read_excel(res_unet_path, engine='openpyxl', index_col=0)
    df_unet = pd.read_excel(unet_path, engine='openpyxl', index_col=0)
    df_contextual = pd.read_excel(contextual_path, engine='openpyxl', index_col=0)
    df_gloria = pd.read_excel(gloria_path, engine='openpyxl', index_col=0)
    df_lavt = pd.read_excel(lavt_path, engine='openpyxl', index_col=0)

    # gets the prediction from the dataframe for the image specified for all 5 examples
    row_res_unet = df_res_unet.loc[img_name]
    prediction_res_unet = row_res_unet['prediction']

    row_unet = df_unet.loc[img_name]
    prediction_unet = row_unet['prediction']

    if str(prediction_unet) == "":
        prediction_unet = "0"
    row_contextual = df_contextual.loc[img_name]
    prediction_contextual = row_contextual['prediction']

    row_gloria = df_gloria.loc[img_name]
    prediction_gloria = row_gloria['prediction']

    row_lavt = df_lavt.loc[img_name]
    prediction_lavt = row_lavt['prediction']

    target = row_contextual['target']

    #print(f"resnet 50 dice: {row_res_unet['dice']}")
    #print(f"Unet dice: {row_unet['dice']}")
    #print(f"Gloria dice: {row_gloria['dice']}")
    #print(f"LAVT dice: {row_lavt['dice']}")
    #print(f"Contextual net dice: {row_contextual['dice']}")

    vision_max = min(row_res_unet['dice'], row_unet['dice'],row_gloria['dice'])
    if row_contextual['dice'] > vision_max or row_lavt['dice'] > vision_max:
        print("multimodal_outperformed outperformed")
        return lavt_cnt, con_cnt

    if row_contextual['dice'] > row_lavt['dice']:
        con_cnt+=1
    else:
        lavt_cnt+=1


    target = rle_decode(target, (1024, 1024))
    try:
        prediction_res_unet = rle_decode(prediction_res_unet, (1024, 1024))
    except:
        prediction_res_unet = np.zeros((1024, 1024))
    try:
        prediction_unet = rle_decode(prediction_unet, (1024, 1024))
    except:
        prediction_unet = np.zeros((1024, 1024))
    try:
        prediction_contextual = rle_decode(prediction_contextual, (1024, 1024))
    except:
        prediction_contextual = np.zeros((1024, 1024))
    try:
        prediction_gloria = rle_decode(prediction_gloria, (1024, 1024))
    except:
        prediction_gloria = np.zeros((1024, 1024))
    try:
        prediction_lavt = rle_decode(prediction_lavt, (480, 480))
        prediction_lavt = resize_array(prediction_lavt, (1024, 1024))
    except:
        prediction_lavt = np.zeros((1024, 1024))


    data_path = "Z:/public_datasets/candid_ptx/dataset1/dataset/"

    img_path = os.path.join(data_path, img_name)
    DCM_Img = pdcm.read_file(img_path)
    img_raw = DCM_Img.pixel_array
    img_raw = img_raw * (255 / np.amax(img_raw))  # puts the highest value at 255
    img_raw = np.uint8(img_raw)
    img_raw = cv2.cvtColor(img_raw, cv2.COLOR_GRAY2RGB)

    f, ax = plt.subplots(1, 7, figsize=(10, 8), dpi=300)

    ax[0].imshow(img_raw)
    ax[0].set_title('Input', size=10)

    res_image = np.copy(img_raw).astype(np.float32)
    res_image[:,:,1] += prediction_res_unet * np.round(255 / 3)
    res_image = res_image/np.max(res_image)
    ax[1].imshow(res_image)
    ax[1].set_title(f'Res {float(row_res_unet["dice"]):.2f}', size=10)
    #ax[2].imshow(img_raw, cmap=plt.cm.bone, alpha=.5)

    unet_image = np.copy(img_raw).astype(np.float32)
    unet_image[:,:,1] += prediction_unet * np.round(255 / 3)
    unet_image = unet_image/np.max(unet_image)
    ax[2].imshow(unet_image)
    ax[2].set_title(f"Unet {float(row_unet['dice']):.2f}", size=10)

    gloria_image = np.copy(img_raw).astype(np.float32)
    gloria_image[:, :, 1] += prediction_gloria * np.round(255 / 3)
    gloria_image = gloria_image / np.max(gloria_image)
    ax[3].imshow(gloria_image)
    ax[3].set_title(f'Glria {float(row_gloria["dice"]):.2f}', size=10)
    #ax[4].imshow(prediction_gloria, cmap="jet", alpha=1)
    #ax[4].imshow(img_raw, cmap=plt.cm.bone, alpha=.5)

    lavt_image = np.copy(img_raw).astype(np.float32)
    lavt_image[:, :, 1] += prediction_lavt * np.round(255 / 3)
    lavt_image = lavt_image / np.max(lavt_image)
    ax[4].imshow(lavt_image)
    ax[4].set_title(f'LAVT: {float(row_lavt["dice"]):.2f}', size=10)
    #ax[5].imshow(img_raw, cmap=plt.cm.bone, alpha=.5)

    contextual_image = np.copy(img_raw).astype(np.float32)
    contextual_image[:, :, 1] += prediction_contextual * np.round(255 / 3)
    contextual_image = contextual_image / np.max(contextual_image)
    ax[5].imshow(contextual_image)
    ax[5].set_title(f'CON: {float(row_contextual["dice"]):.2f}', size=10)
    #ax[1].imshow(prediction_contextual, cmap="jet", alpha=1)
    #ax[1].imshow(img_raw, cmap=plt.cm.bone, alpha=.5)

    target_image = np.copy(img_raw).astype(np.float32)
    target_image[:,:,1] += target * np.round(255 / 3)
    target_image = target_image/np.max(target_image)
    ax[6].imshow(target_image)
    ax[6].set_title('Target', size=10)

    ax[0].axes.xaxis.set_visible(False)
    ax[0].axes.yaxis.set_visible(False)
    ax[1].axes.xaxis.set_visible(False)
    ax[1].axes.yaxis.set_visible(False)
    ax[2].axes.xaxis.set_visible(False)
    ax[2].axes.yaxis.set_visible(False)
    ax[3].axes.xaxis.set_visible(False)
    ax[3].axes.yaxis.set_visible(False)
    ax[4].axes.xaxis.set_visible(False)
    ax[4].axes.yaxis.set_visible(False)
    ax[5].axes.xaxis.set_visible(False)
    ax[5].axes.yaxis.set_visible(False)
    ax[6].axes.xaxis.set_visible(False)
    ax[6].axes.yaxis.set_visible(False)

    path_location = "Z:/Zach_Analysis/dgx_images/model_output_comparisons/all_models_plotted/multimodal_worse/seed915/" + str(img_name) + ".png"
    plt.savefig(path_location)
    #plt.show()
    plt.clf()
    plt.cla()
    return lavt_cnt, con_cnt




def save_off_individual_images(img_name, seed):
    # img_name = "3.5.42.942629.53.2.0.6.90921253161.7144624509648.6"
    # img_name = "8.2.871.805351.9.703.0.9967444461.1812958023.411720"
    # img_name = "7.0.31.925295.30.8.2.1.086175070283447.4416060742930.8"
    # seed = 915
    # dir_base = "/UserData/"
    dir_base = "Z:/"
    target_path_base = os.path.join(dir_base,
                                    "Zach_Analysis/result_logs/candid_result/image_text_segmentation_for_paper/higher_res_for_paper/")

    target_location_res_unet = "basic_unet_from_smp_v34/seed" + str(seed) + "/prediction_dataframe_seed" + str(
        seed) + ".xlsx"
    target_location_unet = "baseline_unet_positive_cases_vision_larger_img_v20/seed" + str(
        seed) + "/prediction_dataframe_seed" + str(seed) + ".xlsx"
    target_location_contextual_net = "language_att_no_text_aug_larger_img_v24/seed" + str(
        seed) + "/prediction_dataframe_seed" + str(seed) + ".xlsx"
    target_location_gloria = "gloria_image_encoder_v36/seed" + str(seed) + "/prediction_dataframe_seed" + str(
        seed) + ".xlsx"
    target_lavt = "Z:/Zach_Analysis/result_logs/candid_result/image_text_segmentation_for_paper/higher_res_for_paper/LAVT_v50/seed" + str(seed) + "/prediction_dataframe_seed" + str(
        seed) + ".xlsx"
    res_unet_path = os.path.join(target_path_base, target_location_res_unet)
    unet_path = os.path.join(target_path_base, target_location_unet)
    contextual_path = os.path.join(target_path_base, target_location_contextual_net)
    gloria_path = os.path.join(target_path_base, target_location_gloria)
    lavt_path = os.path.join(target_path_base, target_lavt)

    df_res_unet = pd.read_excel(res_unet_path, engine='openpyxl', index_col=0)
    df_unet = pd.read_excel(unet_path, engine='openpyxl', index_col=0)
    df_contextual = pd.read_excel(contextual_path, engine='openpyxl', index_col=0)
    df_gloria = pd.read_excel(gloria_path, engine='openpyxl', index_col=0)
    df_lavt = pd.read_excel(lavt_path, engine='openpyxl', index_col=0)

    # gets the prediction from the dataframe for the image specified for all 5 examples
    row_res_unet = df_res_unet.loc[img_name]
    prediction_res_unet = row_res_unet['prediction']

    row_unet = df_unet.loc[img_name]
    prediction_unet = row_unet['prediction']

    if str(prediction_unet) == "":
        prediction_unet = "0"
    row_contextual = df_contextual.loc[img_name]
    prediction_contextual = row_contextual['prediction']

    row_gloria = df_gloria.loc[img_name]
    prediction_gloria = row_gloria['prediction']

    row_lavt = df_lavt.loc[img_name]
    prediction_lavt = row_lavt['prediction']

    target = row_contextual['target']

    print(f"resnet 50 dice: {row_res_unet['dice']}")
    print(f"Unet dice: {row_unet['dice']}")
    print(f"Gloria dice: {row_gloria['dice']}")
    print(f"LAVT dice: {row_lavt['dice']}")
    print(f"Contextual net dice: {row_contextual['dice']}")

    target = rle_decode(target, (1024, 1024))
    try:
        prediction_res_unet = rle_decode(prediction_res_unet, (1024, 1024))
    except:
        prediction_res_unet = np.zeros((1024, 1024))
    try:
        prediction_unet = rle_decode(prediction_unet, (1024, 1024))
    except:
        prediction_unet = np.zeros((1024, 1024))
    try:
        prediction_contextual = rle_decode(prediction_contextual, (1024, 1024))
    except:
        prediction_contextual = np.zeros((1024, 1024))
    try:
        prediction_gloria = rle_decode(prediction_gloria, (1024, 1024))
    except:
        prediction_gloria = np.zeros((1024, 1024))
    try:
        prediction_lavt = rle_decode(prediction_lavt, (480, 480))
        prediction_lavt = resize_array(prediction_lavt, (1024, 1024))
    except:
        prediction_lavt = np.zeros((1024, 1024))

    data_path = "Z:/public_datasets/candid_ptx/dataset1/dataset/"

    # if folder doesn't exist create it
    folder_path = "Z:/Zach_Analysis/dgx_images/model_output_comparisons/all_models_plotted/individual_plots_red/seed915/"
    folder_name = str(img_name) + "cropped"
    folder_path = os.path.join(folder_path, folder_name)
    if not os.path.exists(folder_path):
        # Create the folder if it doesn't exist
        os.makedirs(folder_path)


    img_path = os.path.join(data_path, img_name)
    DCM_Img = pdcm.read_file(img_path)
    img_raw = DCM_Img.pixel_array
    print(f"max value in img_raw: {np.amax(img_raw)}")
    img_raw = img_raw * (255 / np.amax(img_raw))  # puts the highest value at 255
    img_raw = np.uint8(img_raw)
    img_raw = cv2.cvtColor(img_raw[75:949, 100:974], cv2.COLOR_GRAY2RGB)

    plt.figure()

    plt.imshow(img_raw)
    #plt.title("name of raw image")
    plt.axis("off")
    plt.savefig(folder_path + "/raw_image.png", bbox_inches='tight', pad_inches=0)
    plt.close()

    plt.figure()
    res_image = np.copy(img_raw).astype(np.float32)
    res_image[:, :, 0] += prediction_res_unet[75:949, 100:974] * np.round(255 / 3)
    res_image = res_image / np.max(res_image)
    plt.imshow(res_image)
    #plt.title(f'Res {float(row_res_unet["dice"]):.2f}', size=10)
    plt.axis("off")
    plt.savefig(folder_path + "/resnet_dice_" + str(row_res_unet["dice"]) + ".png", bbox_inches='tight', pad_inches=0)
    plt.close()

    plt.figure()
    unet_image = np.copy(img_raw).astype(np.float32)
    unet_image[:, :, 0] += prediction_unet[75:949, 100:974] * np.round(255 / 3)
    unet_image = unet_image/np.max(unet_image)
    plt.imshow(unet_image)
    #ax[2].imshow(unet_image)
    #ax[2].set_title(f"Unet {float(row_unet['dice']):.2f}", size=10)
    plt.axis("off")
    plt.savefig(folder_path + "/unet_" + str(row_unet["dice"]) + ".png", bbox_inches='tight', pad_inches=0)
    plt.close()


    plt.figure()
    gloria_image = np.copy(img_raw).astype(np.float32)
    gloria_image[:, :, 0] += prediction_gloria[75:949, 100:974] * np.round(255 / 3)
    gloria_image = gloria_image / np.max(gloria_image)
    #ax[3].imshow(gloria_image)
    #ax[3].set_title(f'Glria {float(row_gloria["dice"]):.2f}', size=10)
    plt.imshow(gloria_image)
    #ax[4].imshow(prediction_gloria, cmap="jet", alpha=1)
    #ax[4].imshow(img_raw, cmap=plt.cm.bone, alpha=.5)
    plt.axis("off")
    plt.savefig(folder_path + "/gloria_dice_" + str(row_gloria["dice"]) + ".png", bbox_inches='tight', pad_inches=0)
    plt.close()


    plt.figure()
    lavt_image = np.copy(img_raw).astype(np.float32)
    lavt_image[:, :, 0] += prediction_lavt[75:949, 100:974] * np.round(255 / 3)
    lavt_image = lavt_image / np.max(lavt_image)
    plt.imshow(lavt_image)
    #ax[4].imshow(lavt_image)
    #ax[4].set_title(f'LAVT: {float(row_lavt["dice"]):.2f}', size=10)
    #ax[5].imshow(img_raw, cmap=plt.cm.bone, alpha=.5)
    plt.axis("off")
    plt.savefig(folder_path + "/lavt_dice_" + str(row_lavt["dice"]) + ".png", bbox_inches='tight', pad_inches=0)
    plt.close()

    plt.figure()
    contextual_image = np.copy(img_raw).astype(np.float32)
    contextual_image[:, :, 0] += prediction_contextual[75:949, 100:974] * np.round(255 / 3)
    contextual_image = contextual_image / np.max(contextual_image)
    plt.imshow(contextual_image)
    #ax[5].imshow(contextual_image)
    #ax[5].set_title(f'CON: {float(row_contextual["dice"]):.2f}', size=10)
    #ax[1].imshow(prediction_contextual, cmap="jet", alpha=1)
    #ax[1].imshow(img_raw, cmap=plt.cm.bone, alpha=.5)
    plt.axis("off")
    plt.savefig(folder_path + "/contextual_dice_" + str(row_contextual["dice"]) + ".png", bbox_inches='tight', pad_inches=0)
    plt.close()

    plt.figure()
    target_image = np.copy(img_raw).astype(np.float32)
    target_image[:, :, 1] += target[75:949, 100:974] * np.round(255 / 3)
    target_image = target_image/np.max(target_image)
    plt.imshow(target_image)
    #ax[6].imshow(target_image)
    #ax[6].set_title('Target', size=10)
    plt.axis("off")
    plt.savefig(folder_path + "/target_overlay.png", bbox_inches='tight', pad_inches=0)
    plt.close()



if __name__ == '__main__':
    dir_base = "Z:/"
    seed = 915
    target_path_base = os.path.join(dir_base, "Zach_Analysis/result_logs/candid_result/image_text_segmentation_for_paper/higher_res_for_paper/")
    target_location_contextual_net = "language_att_no_text_aug_larger_img_v24/seed" + str(seed) + "/prediction_dataframe_seed" + str(seed) + ".xlsx"
    contextual_path = os.path.join(target_path_base, target_location_contextual_net)
    df_contextual = pd.read_excel(contextual_path, engine='openpyxl', index_col=0)
    i = 0
    lavt_count = 0
    con_count = 0
    for index_value in df_contextual.index:
        i += 1
        print(f"new example {i}: {index_value}")
        if i < 0:
            continue

        if index_value != "0.4.21.415218.39.8.5.0.52241367825.7164808880857.9":
            continue


        #lavt_count, con_count = make_plots_for_all_models(img_name = index_value, seed = 915, lavt_cnt = lavt_count, con_cnt = con_count)
        save_off_individual_images(img_name = index_value, seed = 915)
        #print(f"lavt count: {lavt_count}")
        #print(f"contextual count: {con_count}")
    #print(f"lavt count: {lavt_count}")
    #print(f"contextual count: {con_count}")